<div class="content-box mb-3 content-lighten">
    <h2><i class="fa fa-book fa-fw"></i>Azure と PeachPie を利用したPHP</h2>
    <p>秀丸とは直接関係がありませんが、Visual Studio Codeではなく、Visual Studioで.phpサイトを管理したい場合<br>
        PeachPieを利用することもひとつの手段です。</p>
    <p>ここでは、Azureの「無料枠」を利用して、PeachPieを利用して.phpをwebへと公開する方法が紹介されています。</p>
</div>

<div class="content-box mb-3 content-lighten">
    <h3>Visual Studio から PHP構成のサイトを、「.NET5 Windows」設定の Azure へと発行</h3>
    <p>「構成物としてはPHP」のサイトでありながら、「.NET5 WindowsのFreeサーバー」で、<br>
        「Visual Studioから発行する形」で運営したい場合、<br>
        ややマイナーな仕組みではありますが「PeachPie」を利用するのが良いかもしれません。
    </p>
    <h4>「PeachPie」をVisual Studioの拡張セットとしてインストール</h4>
    <figure class="figure">
        <img src="./other_soft/hm_php/cnt_hm_peachpie_azure_01.png" class="img-fluid content-img img-thumbnail">
        <figcaption class="figure-caption text-right">メニューの「拡張機能の管理」から</figcaption>
    </figure>
    <h4>「PeachPie」の「ASP.NET Core Web App」を選択</h4>
    <figure class="figure">
        <img src="./other_soft/hm_php/cnt_hm_peachpie_azure_02.png" class="img-fluid content-img img-thumbnail">
        <figcaption class="figure-caption text-right">2021年9月現在では、PeachPieのWebアプリは.NET5</figcaption>
    </figure>
    <h4>デフォルトの構成</h4>
    <figure class="figure">
        <img src="./other_soft/hm_php/cnt_hm_peachpie_azure_03.png" class="img-fluid content-img img-thumbnail">
        <figcaption class="figure-caption text-right">デフォルトの構成</figcaption>
    </figure>
    <h4>下の例でいうと「Web2」と「wwwroot」は同じディレクトリだと考える</h4>
    <p>下の例でいうと、「Web2」と「wwwroot」は同じディレクトリであると考えます。<br>
        その上で、「.php」は「Web2」の方に、それ以外は「wwwroot」の方に入れます。</p>
    <p><mark>同じディレクトリ想定なのに、.php だけ「Web2」の方に入れる理由は、<br>
            「PeachPie」では「.php」はそのままは利用されず、.dllへとコンパイルされて<br>
            その場所に該当の.phpは存在しないのに、まるで存在するかのように振る舞う</mark>からです。</p>
    <figure class="figure">
        <img src="./other_soft/hm_php/cnt_hm_peachpie_azure_04.png" class="img-fluid content-img img-thumbnail">
        <figcaption class="figure-caption text-right">「Web2」と「wwwroot」は同じディレクトリと考える</figcaption>
    </figure><br>
    <h4>ソースを編集してみる</h4>
    <figure class="figure">
        <img src="./other_soft/hm_php/cnt_hm_peachpie_azure_05.png" class="img-fluid content-img img-thumbnail">
        <figcaption class="figure-caption text-right">「Web2」と「wwwroot」は同じディレクトリと考え、編集</figcaption>
    </figure>
    <div class="nav nav-tabs" id="nav-tab" role="tablist">
        <a class="nav-item nav-link active" id="nav-1-tab" data-toggle="tab" href="#nav-1" role="tab" aria-controls="nav-1" aria-selected="true">index.php</a>
        <a class="nav-item nav-link" id="nav-2-tab" data-toggle="tab" href="#nav-2" role="tab" aria-controls="nav-2" aria-selected="false">index_LIB_contents.php</a>
        <a class="nav-item nav-link" id="nav-3-tab" data-toggle="tab" href="#nav-3" role="tab" aria-controls="nav-3" aria-selected="false">page_iis_initialize.html</a>
        <a class="nav-item nav-link" id="nav-4-tab" data-toggle="tab" href="#nav-4" role="tab" aria-controls="nav-4" aria-selected="false">style.css</a>
    </div>
    <div class="tab-content" id="nav-tabContent">
        <div class="tab-pane fade show active" id="nav-1" role="tabpanel" aria-labelledby="nav-1-tab">
            <div class="code">
                <pre class="brush:php;">&lt;html&gt;
&lt;head&gt;
&lt;link rel="stylesheet" type="text/css" href="./style.css"&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;?php
require( "index_LIB_contents.php" );
?&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>
            </div>
        </div>
        <div class="tab-pane fade" id="nav-2" role="tabpanel" aria-labelledby="nav-2-tab">
            <div class="code">
                <pre class="brush:php;">&lt;?php
$contents = file_get_contents("page_iis_initialize.html");
echo $contents;
?&gt;
</pre>
            </div>

        </div>
        <div class="tab-pane fade" id="nav-3" role="tabpanel" aria-labelledby="nav-3-tab">
            <div class="code">
                <pre class="brush:php;">&lt;p&gt;
    テスト・テスト。CSSが効いてるなら青い文字になる。&lt;/p&gt;

</pre>
            </div>
        </div>
        <div class="tab-pane fade" id="nav-4" role="tabpanel" aria-labelledby="nav-4-tab">
            <div class="code">
                <pre class="brush:php;">body {
    color: blue;
}
</pre>
            </div>
        </div>
    </div>
    <h4>IISでローカルサーバーで確認してみる</h4>
    <figure class="figure">
        <img src="./other_soft/hm_php/cnt_hm_peachpie_azure_11.png" class="img-fluid content-img img-thumbnail">
        <figcaption class="figure-caption text-right">例としてBlazor Server アプリ</figcaption>
    </figure>
    <h4>Web.Serverの方を発行する</h4>
    <figure class="figure">
        <img src="./other_soft/hm_php/cnt_hm_peachpie_azure_06.png" class="img-fluid content-img img-thumbnail">
        <figcaption class="figure-caption text-right">Web2.Serverの方を発行する。</figcaption>
    </figure>
    <h4>Azureを選択</h4>
    <figure class="figure">
        <img src="./other_soft/hm_php/cnt_hm_peachpie_azure_07.png" class="img-fluid content-img img-thumbnail">
        <figcaption class="figure-caption text-right">例としてBlazor Server アプリ</figcaption>
    </figure>
    <h4>Windowsを選択</h4>
    <figure class="figure">
        <img src="./other_soft/hm_php/cnt_hm_peachpie_azure_08.png" class="img-fluid content-img img-thumbnail">
        <figcaption class="figure-caption text-right">例としてBlazor Server アプリ</figcaption>
    </figure>
    <h4>App Server のリソースを事前に用意していないならば、新規に作成</h4>
    <p>事前に.NET5でWindowsのFreeスペースで使っていない場所があるならば、そこを再利用してもよいでしょう。</p>
    <figure class="figure">
        <img src="./other_soft/hm_php/cnt_hm_peachpie_azure_09.png" class="img-fluid content-img img-thumbnail">
        <figcaption class="figure-caption text-right">例としてBlazor Server アプリ</figcaption>
    </figure>
    <figure class="figure">
        <img src="./other_soft/hm_php/cnt_hm_peachpie_azure_10.png" class="img-fluid content-img img-thumbnail">
        <figcaption class="figure-caption text-right">例としてBlazor Server アプリ</figcaption>
    </figure>
    <h4>発行</h4>
    <p>これでWeb上へと公開されました。</p>
    <p>発行した後、「世界で初めて該当URLへとアクセスする人(おそらくWeb作者自身)」だけは、<br>コンパイルが走るため、かなり遅い表示となりますが、<br>それ以降はむしろphpより速くなる傾向があります。<br>
    </p>
</div>