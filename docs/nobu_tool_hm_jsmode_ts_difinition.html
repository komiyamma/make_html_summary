<div class="content-box mb-3 content-lighten">
    <h2><i class="fa fa-typescript fa-fw"></i>秀丸マクロの jsmode 用の TypeScript 定義ファイル とその構成一式</h2>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>概要</h3>
    <p>秀丸エディタ 9.19以降搭載されるjsmodeのJavaScript(ECMAScript)用のTypeScript定義ファイルです。<br></p>
    <p>秀丸エディタのjsmodeはエラーの内容が理解しにくい傾向にあるため、<br>
        <span class="negative">実行してからではなく、記述の段階で</span>の<br>
        ・<mark>スムーズな記述</mark><br>
        ・<mark>文法エラーが無い状態</mark><br>
        ・<mark>型の不整合が無い状態</mark><br>
        が大きなカギとなります。
    </p>
    <p>このように「未然にエラーを検知し、文法エラーや型エラーが無い状態」にしておくことが重要です。</p>
    <p>こういった観点から、<span class="positive">TypeScript定義ファイルとVSCodeを利用したjsmode用JavaScriptの作成がオススメ</span>です。<br>
    </p>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>ダウンロード</h3>
    <div class="card mb-3 ms-3" style="max-width: 30rem;">
        <div class="text-center mt-3">
            <img src="./other_soft/hm_jsmode_ts_definition/cnt_hm_jsmode_ts_definition_minizip.png" attr="noedge">
        </div>
        <div class="card-body text-center">
            <a href="https://github.com/komiyamma/hm_jsmode_ts_definition" class="btn btn-primary"><i class="fa fa-download fa-fw"></i>hm_jsmode.d.ts v<span id="latest_version"> </span></a>
        </div>
    </div>
</div>
<script>
    fetch('https://api.github.com/repos/komiyamma/hm_jsmode_ts_definition/releases/latest')
        .then(response => response.json())
        .then(data => {
            const tagName = data.tag_name;
            document.getElementById("latest_version").innerText = tagName;
        })
        .catch(error => {
        });
</script>
<div class="content-box mb-3 content-lighten">
    <h3>原則的には Visual Studio Codeでの利用を想定</h3>
    <p>JavaScriptを組む上では、Visual Studio Code と 秀丸エディタ では比較対象にすらなりません。<br>
        秀丸エディタのマクロ目的のJavaScriptであったとしても、このあまりに大きな差は決して覆りません。<br>
        普通にVisual Studio Codeで組みましょう。<br>
        <br>
        <span class="positive">行数が増えれば増えるほど、複雑な関数やメソッドを使えば使うほど、<br>
            Visual Studio Codeでの制作の方がはるかに早く組み終える</span>んだなと実感することでしょう。
    </p>
    <ul>
        <li><span class="positive">最高峰の入力補完</span></li>
        <li><span class="positive">変数・関数等にマウスを当てた際のヘルプバルーン表示</span></li>
        <li><span class="positive">入力時のリアルタイムなエラーチェックや型チェック</span></li>
        <li><span class="positive">該当スコープで宣言するべきではない変数名などの警告</span></li>
        <li><span class="positive">使用するべきではない関数への警告</span></li>
        <li><span class="positive">人工知能や機械学習によるコード自動予想や自動提案機能などとの連携</span> (※ <mark>「<i class="fa fa-github-copilot fa-fw"></i>Github Copilot(有料)」など使用時</mark>)</li>
    </ul>
    <p>などの機能や利点を享受出来ます。<br></p>
    <p>
        逆に言えば、<span class="negative">こういった機構を利用しないまま、</span><br>
        <span class="negative">秀丸エディタでjsmode用のJavaScriptを記述していくことは、</span><br>
        <span class="negative">秀丸エディタのエラー表示(エラーの箇所をほとんどまともに補足できない)の問題も大きく、<br>
            相当な熟練者であったとしても、異常なまでの難航が予想されます。</span><br>
    </p>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>ウォークスルー画像</h3>
    <h4>全体構造</h4>
    <img src="./other_soft/hm_jsmode_ts_definition/cnt_hm_jsmode_ts_definition_06.png">
    <h4>通常のユーティリティ目的のjs作成用のTypeScript定義ファイル (hm_jsmode.d.ts)</h4>
    <img src="./other_soft/hm_jsmode_ts_definition/cnt_hm_jsmode_ts_definition_01.png">
    <h4>配布ライブラリ作成者用のTypeScript定義ファイル (hm_jsmode_strict.d.ts)</h4>
    <img src="./other_soft/hm_jsmode_ts_definition/cnt_hm_jsmode_ts_definition_02.png">
    <h4>TypeSccript → JavaScript へのトランスパイル</h4>
    <img src="./other_soft/hm_jsmode_ts_definition/cnt_hm_jsmode_ts_definition_03.png">
    <h4>tsconfig.jsonの編集 (WebView2 で window.*** 利用編)</h4>
    <pre class="line-numbers" data-line="3,4"><code class="language-json">{
  "compilerOptions": {
    "target": "ES2022",
    "lib": ["ES2022", "DOM"],
    "module": "None",
    "strict": false,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "removeComments": false,
    "outDir": "./build",
  },

  "include": ["./src"],
}
</code>
</pre>
    <h4>tsconfig.jsonの編集 (JScript フォーカス編)</h4>
    <pre class="line-numbers" data-line="3,4"><code class="language-json">{
"compilerOptions": {
    "target": "ES5",
    "lib": ["ES5", "ScriptHost"],
    "module": "None",
    "strict": false,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "removeComments": false,
    "outDir": "./build",
},

"include": ["./src"],
}
</code>
</pre>
</div>