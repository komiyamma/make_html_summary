<div class="content-box mb-3 content-lighten">
<h2><i class="fa fa-book fa-fw"></i>入門編 ～マクロ実行中なのか、マクロ実行中以外なのか～</h2>
</div>
<div class="content-box mb-3 content-lighten">
        <h3>概要</h3>
        <p>
            hm.NETでは通常、マクロを実行して、「マクロ実行中の一瞬の間」で、あなたが制作した「.dll」を読み込み＆実行し、<br>
            マクロの実行が終わった後も、.dll内では常駐しつづけて続きの処理を実行する、というパターンが一般的となります。<br>
            <mark>この「マクロ実行中か否」かは、 「hm.NET の制限」と「マクロスコープ」の関係を理解する上で最重要ですので読み流さないようにしてください。</mark>
        </p>
</div>
<div class="content-box mb-3 content-lighten">
        <h3>マクロ実行中かどうか
        </h3>
        <ul class="pointlist">
            <li>
                <h4>C#側のソース</h4>
                <p>マクロ中でもマクロ中以外でも、常時取得することが出来ます。</p>
                <blockquote>Hm.Macro.IsExecuting</blockquote>
                <fieldset class="code">
                    <legend>MyTestForm.cs</legend><pre class="brush:csharp">using System;
using System.Windows.Forms;
using Hidemaru;

namespace HmTest
{
    partial class HmTestForm
    {
        protected void MethodCreate()
        {
            System.Diagnostics.Trace.WriteLine("フォーム生成時");

            if (Hm.Macro.IsExecuting)
            {
                System.Diagnostics.Trace.WriteLine("マクロ実行中です。");
            }
            else
            {
                System.Diagnostics.Trace.WriteLine("マクロ実行中ではありません");
            }
        }
        protected void MethodTick()
        {
            if (Hm.Macro.IsExecuting)
            {
                System.Diagnostics.Trace.WriteLine("マクロ実行中です。");
            }
            else
            {
                System.Diagnostics.Trace.WriteLine("マクロ実行中ではありません");
            }
            System.Diagnostics.Trace.WriteLine("チック時");
        }
        protected void MethodDestroy()
        {
            System.Diagnostics.Trace.WriteLine("フォームクローズ時");
        }
    }

}

</pre>
                </fieldset>

           </li><li>
                <h4>秀丸マクロ側のソース</h4>
                <p>前章の「HmNETTest.mac」と同一です。<br>
                    一度マクロを実行し、「デバッグモニター」にどのように順次表示されるか確認しましょう。</p>
        </li></ul>
</div>
